# @uniper/ues-react-style

![release workflow](https://github.com/uniper/ues-react-style/actions/workflows/build-release.yml/badge.svg)

# Table of Contents

1. [Setup](#setup)
   1. [Install](#install)
   2. [Configure icons css](#configure-icons-css)
2. [Usage](#usage)
   1. [ThemeProvider](#themeprovider)
   2. [Icon](#icon)
   3. [HelperText](#helpertext)
   4. [User prompts](#user-prompts)
   5. [Buttongroup](#buttongroup)
   6. [Spinner](#spinner)
   7. [Colors](#colors)
   8. [Font](#font)

# Setup

## Install

**peerDependencies**

```
"react": "^19.0.0",
"@emotion/react": "^11.10.0",
"@emotion/styled": "^11.10.0",
"@mui/material": "^6.0.1",
"@mui/system": "^6.0.1",
"@mui/x-data-grid-premium": "^7.0.0",
"@mui/x-data-grid-pro": "^7.0.0",
"@mui/x-date-pickers-pro": "^7.0.0"
```

**package**

```
yarn add @uniper/ues-react-style
```

## License

### DataGridPro

The license for DataGridPro must be activated as indicated below if you want to use it.

```
import { initMuiXDataGridProLicense } from '@uniper/ues-react-style';
initMuiXDataGridProLicense();
```

## Global style for Fonts and Icons

Add the following `link` tag to your local html file so that the global styles (text and icon fonts) are loaded when the application is started locally.

```html
<link rel="stylesheet" href="https://ues-sales-portal-dev.azurefd.net/styles/uniper-global.css" />
```

### ModuleFederation micro-frontends

For ModuleFederated integration the global styles (text and icon fonts) are already loaded from the shell application.

### WebComponent micro-frontends

The global styles are automatically loaded if you use the provided custom element base class [StyledWebComponentEntry](https://github.com/uniper/ues-sales-portal/blob/main/libs/webcomponent-integration-react/src/integration/StyledWebComponentEntry.tsx#L15).
The base class also ensures that there is a style cache provider initializied so that the MUI styles can work properly.

# Usage

## ThemeProvider

When using MUI components that render on an elevated level (Modal, Popover etc.) within a WebComponent it is necessary to provide a container element to the ThemeProvider. This is necessary because otherwise the MUI components are rendered outside the WebComponent (directly under the body tag) and the styles are not applied correctly. If you pass all `themeOptions` to the `UniperThemeProvider` as in the example below this is done automatically.

```tsx
import { UniperThemeProvider, SnackbarOptions } from '@uniper/ues-react-style';

export const EntryBootstrap: FC<PropsWithChildren<PortalAppProps>> = ({ children, portalContext }) => (
  <UniperThemeProvider {...portalContext.themeOptions}>
    <SnackbarProvider {...SnackbarOptions}>{children}</SnackbarProvider>
  </UniperThemeProvider>
);
```

## Icons

Set the name of the icon from zeroheight as className property of the Icon component. The main Icon color can be specified over the color property and the colors from the ThemeProvider can be used. When no color property is specified the primary color is used by default.

```tsx
<Icon className="ico-energy-gas" color="success" />

// Multicolor icons
<Icon className="ico-energy-balancing-services">
  <span className="path1" />
  <span className="path2" />
</Icon>
```

## HelperText

![helper-misaligned](./docs/assets/helper-misaligned.png)

Misaligned components & layout jumps up/down when error or helper text is hidden/visible

Mui docs: [Helper text docs](https://mui.com/material-ui/react-text-field/#helper-text)

**Solution from MUI:**

Add helperText=" " with an empty string to all components on the same row.

```tsx
<TextField helperText=" " id="demo-helper-text-aligned-no-helper" label="Name" />
```

![helper-mui-alignment](./docs/assets/helper-mui-alignment.png)

MUI Solution for helper/error text alignment

**Alternative Solution (recomended option):**

Wrap the components with a Tooltip component which will show the helper text/error message on hover. Based on the used color property the Tooltip will be styled accordingly.

```tsx
<Tooltip color={isError ? 'error' : 'primary'} title={isError ? error.message : helperText}>
  <TextField value={value} onChange={handleChange} label={'label'} error={isError} />
</Tooltip>
```

![helper-mui-alignment](./docs/assets/info-tooltip.png)

Info Tooltip

![helper-mui-alignment](./docs/assets/error-tooltip.png)

Error Tooltip

## User prompts

Add short hints as a placeholder text.

```tsx
<TextField value={value} onChange={handleChange} label={label} placeholder={shortPrompt} />
```

![helper-mui-alignment](./docs/assets/user-prompts.png)

Hint as a placeholder

## ButtonGroup

Align all Components to the bottom of the row and use FormControl and FormLabel to add a label over the ButtonGroup.

:construction: **TODO**

```tsx
<Grid container direction="row" alignItems="flex-end">
  ...
  <Grid item xs={2}>
    <FormControl fullWidth>
      <FormLabel>{label}</FormLabel>
      <ButtonGroup fullWidth aria-label={ariaLabel}>
        ...
      </ButtonGroup>
    </FormControl>
  </Grid>
</Grid>
```

![helper-mui-alignment](./docs/assets/button-group.png)

Example with a ButtonGroup

## Spinner

```tsx
// Use MUI spinner:
<CircularProgress />

//Use custom spinner:
<LoadingSpinner />
```

:construction: **TODO - Clarify which spinner should be used.**

## Colors

**To be considered:**

The semantics of each color used in the MUI color palette. e.g. Where and in which situations is secondary used or where is text color used? What surfaces do the components use? e.g. paper or default.

:construction: **TODOs:**

- Check if currently used colors are the correct ones for the light mode
- Define color shades for secondary
- Define color palette for dark mode
- Follow the material concept and specify where the default surface and where the paper surface should be used. Specify background colors for the default and paper surface (for dark and light mode).

**Light palette:**

```typescript
const lightPalette: PaletteOptions = {
  ...basePalette,
  mode: 'light',
  primary: {
    light: colors.primary100,
    main: colors.primary500,
    dark: colors.primary700,
  },
  secondary: {
    light: colors.secondary500,
    main: colors.secondary500,
    dark: colors.secondary500,
  },
  error: {
    100: colors.error100,
    500: colors.error500,
  },
  warning: {
    500: colors.warning500,
  },
  info: {
    500: colors.secondary500,
  },
  success: {
    500: colors.success500,
  },
  // tonalOffset?: PaletteTonalOffset;
  // contrastThreshold?: number;
  text: {
    primary: colors.primary700,
    secondary: colors.primary500,
    disabled: colors.neutral500,
  },
  // divider?: string;
  // action?: Partial<TypeAction>;
  background: {
    // default: colors.primary700,
    // paper: colors.primary700,
  },
  // getContrastText?: (background: string) => string;
};
```

**Dark palette:**

```typescript
const darkPalette: PaletteOptions = {
  ...basePalette,
  mode: 'dark',
  primary: {
    light: colors.primary100,
    main: colors.primary500,
    dark: colors.primary700,
  },
  secondary: {
    light: colors.secondary500,
    main: colors.secondary500,
    dark: colors.secondary500,
  },
  error: {
    100: colors.error100,
    500: colors.error500,
  },
  warning: {
    500: colors.warning500,
  },
  info: {
    500: colors.secondary500,
  },
  success: {
    500: colors.success500,
  },
  // tonalOffset?: PaletteTonalOffset;
  // contrastThreshold?: number;
  text: {
    primary: colors.primary100,
    secondary: colors.primary100,
    disabled: colors.neutral100,
  },
  // divider?: string;
  // action?: Partial<TypeAction>;
  background: {
    // default: colors.primary700,
    // paper: colors.primary700,
  },
  // getContrastText?: (background: string) => string;
};
```

## Font

The font was created using the [icomoon](https://icomoon.io/app) app. Import [uniper-icons.json](./docs/uniper-icons.json) to use the current font state for generic icons 
and import [uniper-app-icons.json](./docs/uniper-app-icons.json) to use the current font state for app icons.
**Ensure that you always import both files so that generated icon codes are unique.**
So far, all SVGs were normalized and centered in their viewports using 32x32 or 64x32 grids for two types of icons respectively - single and double sized.

Remember to adjust the preferences of the font you are generating to have the font name `uniper-icons` or `uniper-app-icons` and css selector `.uniper-icons` or `.uniper-app-icons` respectively. 

Once the new version of the font is exported the following steps must be performed:

- remove the uniper blue primary color from all css classes that don't contain also `.path<X>` class. The main icon color is applied from the MUI Theme.

```css
.ico-arrows-arrow-circle-down:before {
  content: '\e906';
  color: #0077dc; // REMOVE
}
```

- convert the woff font file to woff2 ([online converter](https://cloudconvert.com/woff-to-woff2)) and add it to the `style.css`

```css
src:
  url('fonts/uniper-icons.ttf?w24suk') format('truetype'),
  url('fonts/uniper-icons.woff?w24suk') format('woff'),
  url('fonts/uniper-icons.woff2?w24suk') format('woff2'),
  // ADD woff2
  url('fonts/uniper-icons.svg?w24suk#uniper-icons') format('svg');
```

The resulting four font files and css file should be updated in the [uniper-pegasus-infrastructure repo](https://github.com/uniper/uniper-pegasus-infrastructure/tree/main/__shared_resources/cdn_assets)

- inside the uniper-pegasus-infrastructure repo, increment the version of the import and font-faces files in `uniper-icons.css` and `uniper-global.css`

```css
src:
  url('fonts/uniper-icons.ttf?1') format('truetype'), --> url('fonts/uniper-icons.ttf?2') format('truetype'),
  url('fonts/uniper-icons.woff?1') format('woff'), --> url('fonts/uniper-icons.woff?2') format('woff'),
  url('fonts/uniper-icons.woff2?1') format('woff2'), --> url('fonts/uniper-icons.woff2?2') format('woff2'),
  url('fonts/uniper-icons.svg?1#uniper-icons') format('svg'); --> url('fonts/uniper-icons.svg?2#uniper-icons') format('svg');
```

- depending on which icon font you updated, update the `.ico-...` definitions in `uniper-icons.css` or `uniper-app-icons.css` accordingly
