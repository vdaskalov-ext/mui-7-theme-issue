# portal-components

This library contains reusable components to be used for apps within the Sales Portal.

# Storybook Documentation

You can start the storybook documentation by running `yarn storybook:portal-components` or `nx run portal-components:storybook`.

## Usage

Take a look at the example usage of available components:

```typescript jsx
import { Button, TextField } from "@mui/material";
import {
  AccessRestrictionType,
  AllowCopy,
  ConfirmationDialogProvider,
  DisableFields,
  DisableFieldsTranslationProvider,
  ErrorBoundary,
  PortalContextProvider,
  RBACTranslationProvider,
  salesPortalRoles,
  useConfirmationDialog,
  WidthLimiter,
} from '@uniper/ues-sales-portal-components';
import { PortalAppProps } from '@uniper/ues-sales-portal-context';
import { use } from "i18next";
import { FC, PropsWithChildren } from 'react';

export const App: FC<PortalAppProps> = ({ portalContext }) => (
  <PortalContextProvider context={portalContext}> {/* Provides theme, language and services to your app */}
    <SalesPortalProviders>
      {/* Your other providers may go here or above */}
      <YourApp />
    </SalesPortalProviders>
  </PortalContextProvider>
);

const SalesPortalProviders: FC<PropsWithChildren> = ({ children }) => {
  const { t } = useTranslation(); /*from wherever*/

  return (
    <ErrorBoundary> {/*Catches errors in its children and displays a fallback UI. It is integrated with the portal for error reporting*/}
      <ChipAutocompleteProvider
        translation={{
          tInvalidFiltered: (invalid) => t('ChipAutocomplete.invalidFiltered', { invalid }),
          tDuplicateFiltered: (duplicate) => t('ChipAutocomplete.duplicateFiltered', { duplicate }),
          tMaxItems: (maxItems) => t('ChipAutocomplete.maxItems', { maxItems }),
          tAlreadyContained: (item) => t('ChipAutocomplete.alreadyContained', { item }),
          placeholder: t('ChipAutocomplete.placeholder'),
        }}
      >
        <RBACTranslationProvider
          missingRoleMessage={(roles) => t(`Should be internationalized: ${roles.join(', ')}`)}>
          <DisableFieldsTranslationProvider defaultMessage={t('i18n-Message')}>
            <ConfirmationDialogProvider
              translation={{ confirmation: { confirm: { label: t('confirm') } }, abort: { label: t('abort') } }}>
              {/* Your other providers may go here or above */}
              <WidthLimiter maxWidth={1920}> {/* Ensure a max width for larger screens */}
                {children}
              </WidthLimiter>
            </ConfirmationDialogProvider>
          </DisableFieldsTranslationProvider>
        </RBACTranslationProvider>
      </ChipAutocompleteProvider>
    </ErrorBoundary>
  )
}

const YourApp = () => {
  const { show } = useConfirmationDialog({
    title: 'Title', description: 'Description', onConfirm: () => {
      /*do something*/
    }
  })

  return (
    <>
      <RBAC roles={[salesPortalRoles.ADMIN]}
            restrictionType={AccessRestrictionType.HIDE}> {/* Hides the button if the user does not have the ADMIN role */}
        <Button onClick={() => show()} />
      </RBAC>
      <DisableFields rules={[{ disabled: false }, { disabled: true, message: "Displayed in a tooltip" }]}>
        <TextField />
      </DisableFields>
    </>
  );
}
```
